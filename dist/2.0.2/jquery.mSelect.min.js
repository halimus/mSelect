/* 
 * mSelect 2.0.2 for Bootstrap v3 - https://github.com/halimus/mSelect
 * Updated on: Sep 27, 2019
 * Author: Halim Lardjane
 * 
 */
!function(e){"use strict";var t="https://mselect.info/docs/pages/quickstart.html",l={en:{none_selected:"None selected",selected:"selected",show_selected:"Show selected",show_all:"Show all",refresh:"Refresh"},fr:{none_selected:"Aucune sélection",selected:"sélectionnées",show_selected:"Voir sélectionnées",show_all:"Voir tout",refresh:"Rafraîchir"},es:{none_selected:"Ninguna seleccionada",selected:"seleccionadas",show_selected:"Mostrar seleccionado",show_all:"Mostrar todo",refresh:"Refrescar"},pt:{none_selected:"Nenhum selecionado",selected:"selecionadas",show_selected:"Mostrar selecionado",show_all:"Mostre tudo",refresh:"Atualizar"},ru:{none_selected:"Не выбрано",selected:"выбран",show_selected:"Показать выбранное",show_all:"Показать все",refresh:"обновление"},zh:{none_selected:"未选择",selected:"选中",show_selected:"显示已选中",show_all:"显示所有",refresh:"刷新"},ja:{none_selected:"何も選択されていません",selected:"つ選択",show_selected:"選択を表示",show_all:"すべて表示する",refresh:"更新する"}},n="fa fa-eye",a="fa fa-eye-slash",s="#666",i="#666",c={indexLabel:1,uniqueLabel:!1};e.fn.mSelect=function(r){var d,o={plugin_id:function e(){var t=Date.now();t<=e.previous?t=++e.previous:e.previous=t;return t}(),table_id:null,columns:["Name"],url:null,data:{},ajax_var_name:"ids",prependData:null,selectedIds:[],returnSelectedLabels:{enable:!1,indexLabel:1,uniqueLabel:!1},fullSelectedLabels:[],uniqueSelectedLabels:[],loadWhenOpen:!1,disableIfEmpty:!1,disable:!1,reset:!1,minWidth:350,buttonWidth:null,cssNotEmpty:null,nonSelectedText:null,selectType:"multi",btnRefresh:!1,btnSelected:{enable:!1,icon1:"fa fa-eye",icon2:"fa fa-eye-slash",color_icon1:"#666",color_icon2:"#666"},applyStyleToDom:{item:null,style:null,currentStyle:null},lengthMenu:[10,20,50],order:[[1,"asc"]],lang:"en",onDropdownShow:function(e){},onDropdownHide:function(e,t,l,n){},onChange:function(e,t,l,n){}},u=e.extend({},o,r),f=this,b=l[u.lang];u.table_id=null===u.table_id?"dt_"+u.plugin_id:u.table_id;var h=!1,p=!1;if(f.check_requirements=function(){return void 0===e.fn.modal?(alert("Bootstrap must be loaded before mSelect.\nCheck the mSelect requirements\n"+t),!1):e.fn.DataTable?e.fn.DataTable.Checkboxes?!!e.fn.multiselect||(alert("Bootstrap multiselect must be loaded before mSelect.\nCheck the mSelect requirements\n"+t),!1):(alert("DataTable Checkboxes must be loaded before mSelect.\nCheck the mSelect requirements\n"+t),!1):(alert("DataTable must be loaded before mSelect.\nCheck the mSelect requirements\n"+t),!1)},f.initialize=function(){if(null!==u.prependData&&""!==u.prependData&&"object"==typeof u.prependData&&(u.data.prependData=u.prependData),"single"==u.selectType&&u.selectedIds.length>1&&u.selectedIds.splice(1),null==u.nonSelectedText&&(u.nonSelectedText=b.none_selected),f.multiselect({nonSelectedText:0==u.selectedIds.length?u.nonSelectedText:u.selectedIds.length+" "+b.selected,buttonWidth:u.buttonWidth}),!0===u.btnSelected.enable&&(u.btnSelected.icon1=void 0===u.btnSelected.icon1?n:u.btnSelected.icon1,u.btnSelected.icon2=void 0===u.btnSelected.icon2?a:u.btnSelected.icon2,u.btnSelected.color_icon1=void 0===u.btnSelected.color_icon1?s:u.btnSelected.color_icon1,u.btnSelected.color_icon2=void 0===u.btnSelected.color_icon2?i:u.btnSelected.color_icon2),!0===u.returnSelectedLabels.enable&&(u.returnSelectedLabels.indexLabel=void 0===u.returnSelectedLabels.indexLabel?c.indexLabel:u.returnSelectedLabels.indexLabel,u.returnSelectedLabels.uniqueLabel=void 0===u.returnSelectedLabels.uniqueLabel?c.uniqueLabel:u.returnSelectedLabels.uniqueLabel,u.returnSelectedLabels.witoutIndex=void 0===u.returnSelectedLabels.witoutIndex?c.witoutIndex:u.returnSelectedLabels.witoutIndex,u.returnSelectedLabels.indexLabel>u.columns.length))return alert("mSelect: The indexLabel "+u.returnSelectedLabels.indexLabel+" must be inside the columns.\n"),!1;u.selectedIds=y(u.selectedIds),u.selectedIds.length>0&&(u.loadWhenOpen=!1);var t="";t+='<div class="mSelect-content" id="mSelect-content_'+u.plugin_id+'" data-id="'+u.plugin_id+'" style="min-width:'+u.minWidth+'px">',t+='<table id="'+u.table_id+'" class="table table-bordered display" width="100%"><thead><tr>',t+='<th><input name="select_all" value="1" type="checkbox"></th>',e.each(u.columns,function(e,l){t+="<th>"+l+"</th>"}),t+="</tr></thead>",e(t+="</table></div>").insertAfter(f.closest("span")),e(this).closest("span").attr("id","mSelect_"+u.plugin_id),e(this).attr("data-id",u.plugin_id);var l=e(this).next("div:first").children("button");return e(l).attr("id","btn_"+u.plugin_id),1==u.disable&&f.multiselect("disable"),!0},!f.check_requirements())return!1;function _(t){g(e(t.target).parents(".mSelect-content")),e.isFunction(u.onChange)&&(L(),u.onChange.call(this,u.selectedIds,u.fullSelectedLabels,u.uniqueSelectedLabels,u.plugin_id))}function g(t){var l=(n=t.prev("span").first()).find("button"),n=n.find("span.multiselect-selected-text"),a=u.selectedIds.length;a>0?(l.attr("title",a+" "+b.selected),n.html(a+" "+b.selected),S()):(l.attr("title",b.none_selected),n.html(b.none_selected),e(l).removeAttr("style"),null!=u.buttonWidth&&e(l).attr("style","width:"+u.buttonWidth))}function S(){var t="";return null!=u.cssNotEmpty&&(t=u.cssNotEmpty+";"),null!=u.buttonWidth&&(t+="width:"+u.buttonWidth),""!=t&&e("#btn_"+u.plugin_id).attr("style",t),!0}function m(){d=e("#"+u.table_id).DataTable({pageLength:u.lengthMenu[0],lengthMenu:u.lengthMenu,pagingType:"full",rowCallback:function(t,l,n){var a=l[0],s=!1;-1!==e.inArray(a,u.selectedIds)&&(e("#"+u.table_id).DataTable().rows(n).select(),null!=u.cssNotEmpty&&!1===s&&(s=S()))},language:w(),destroy:!0,processing:!0,serverSide:!0,deferRender:!0,searchHighlight:!0,autoWidth:!1,paging:!0,order:u.order,ajax:{type:"GET",url:u.url,dataType:"JSON",data:u.data},columnDefs:[{targets:0,searchable:!1,orderable:!1,width:"20px",className:"dt-center",checkboxes:{selectRow:!0}}],select:{style:u.selectType,blurable:!1},dom:"lBfrtip",buttons:[],drawCallback:function(e){var t=this.fnSettings().fnRecordsTotal();!0===u.disableIfEmpty&&0==t&&f.multiselect("disable")}}),p=!0,e("#mSelect-content_"+u.plugin_id+" .dataTables_wrapper").addClass("mSelect_wrapper"),"single"===u.selectType&&e("#mSelect-content_"+u.plugin_id+" .dt-checkboxes-cell").html("");var t=0;!0===u.btnRefresh&&(e("#"+u.table_id).DataTable().button().add(t,{text:'<i class="fa fa-refresh"></i>',titleAttr:b.refresh,enabled:!0,className:"btnx",action:function(e,t,l,n){d.ajax.reload()}}),t++),!0===u.btnSelected.enable&&d.button().add(t,{text:'<i class="'+u.btnSelected.icon1+'" style="color:'+u.btnSelected.color_icon1+'"></i>',titleAttr:b.show_selected,enabled:!0,className:"btn-default btnx btn-selected",action:function(t,l,n,a){if(!0===h)h=!1,e(".btn-selected i").attr("class",u.btnSelected.icon1),e(".btn-selected").attr("title",b.show_selected),e(".btn-selected i").attr("style","color:"+u.btnSelected.color_icon1),d.ajax.url(u.url).load();else{h=!0,e(".btn-selected i").attr("class",u.btnSelected.icon2),e(".btn-selected").attr("title",b.show_all),e(".btn-selected i").attr("style","color:"+u.btnSelected.color_icon2);var s=u.ajax_var_name,i=u.url.indexOf("?")>-1?u.url+"&"+s+"="+u.selectedIds:u.url+"?"+s+"="+u.selectedIds;d.ajax.url(i).load()}}})}function y(e){var t=[];return null!=e&&""!=e&&e.forEach(function(e){t.push(e.toString())}),t}function L(){var t=[];!0===u.returnSelectedLabels.uniqueLabel&&e.each(u.fullSelectedLabels,function(l,n){-1===e.inArray(n.label,t)&&t.push(n.label)}),u.uniqueSelectedLabels=t}function T(){"single"==u.selectType&&u.selectedIds.length>1&&u.selectedIds.splice(1),m(),g(e("#mSelect-content_"+u.plugin_id)),0==u.disable?f.multiselect("enable"):f.multiselect("disable")}function v(){u.selectedIds=[],u.fullSelectedLabels=[],u.uniqueSelectedLabels=[],f.multiselect("refresh"),!0===p&&d.rows().deselect(),g(e("#mSelect-content_"+u.plugin_id))}function x(t){if(null!=u.applyStyleToDom.item&&null!=u.applyStyleToDom.style){var l=e(u.applyStyleToDom.item).attr("style");"open"==t?null!=l&&null!=l?(u.applyStyleToDom.currentStyle=l,e(u.applyStyleToDom.item).attr("style",u.applyStyleToDom.style+";"+l)):e(u.applyStyleToDom.item).attr("style",u.applyStyleToDom.style):null!=l||null!=l?e(u.applyStyleToDom.item).attr("style",u.applyStyleToDom.currentStyle):e(u.applyStyleToDom.item).removeAttr("style")}}function w(){switch(u.lang){case"en":return{search:"",searchPlaceholder:"Search",processing:'<i class="fa fa-spinner fa-spin fa-2x loader"></i>',lengthMenu:"_MENU_",info:"_START_ to _END_ of _TOTAL_ records",zeroRecords:"No matching records found",infoEmpty:"No records available",infoFiltered:"(from _MAX_ records)",paginate:{first:'<i class="fa fa-angle-double-left" title="First"></i>',previous:'<i class="fa fa-angle-left" title="Previous"></i>',next:'<i class="fa fa-angle-right" title="Next"></i>',last:'<i class="fa fa-angle-double-right" title="Last"></i>'}};case"fr":return{search:"",searchPlaceholder:"Rechercher",processing:'<i class="fa fa-spinner fa-spin fa-2x loader"></i>',lengthMenu:"_MENU_",info:"_START_ à _END_ sur _TOTAL_ éléments",zeroRecords:"Aucun élément à afficher",infoEmpty:"Aucun enregistrement disponible",infoFiltered:"(à partir de _MAX_ éléments)",paginate:{first:'<i class="fa fa-angle-double-left" title="Premier"></i>',previous:'<i class="fa fa-angle-left" title="Précédent"></i>',next:'<i class="fa fa-angle-right" title="Suivant"></i>',last:'<i class="fa fa-angle-double-right" title="Dernier"></i>'}};case"es":return{search:"",searchPlaceholder:"Buscar",processing:'<i class="fa fa-spinner fa-spin fa-2x loader"></i>',lengthMenu:"_MENU_",info:"_START_ a _END_ de _TOTAL_ registros",zeroRecords:"No se encontraron resultados",infoEmpty:"Ningún dato disponible en esta tabla",infoFiltered:"(de _MAX_ registros)",paginate:{first:'<i class="fa fa-angle-double-left" title="Primero"></i>',previous:'<i class="fa fa-angle-left" title="Anterior"></i>',next:'<i class="fa fa-angle-right" title="Siguiente"></i>',last:'<i class="fa fa-angle-double-right" title="Último"></i>'}};case"pt":return{search:"",searchPlaceholder:"Primeiro",processing:'<i class="fa fa-spinner fa-spin fa-2x loader"></i>',lengthMenu:"_MENU_",info:"_START_ a _END_ de _TOTAL_ registros",zeroRecords:"Não foram encontrados resultados",infoEmpty:"Nenhum registro encontrado",infoFiltered:"(de _MAX_ registros)",paginate:{first:'<i class="fa fa-angle-double-left" title="Primeiro"></i>',previous:'<i class="fa fa-angle-left" title="Anterior"></i>',next:'<i class="fa fa-angle-right" title="Seguinte"></i>',last:'<i class="fa fa-angle-double-right" title="Último"></i>'}};case"ru":return{search:"",searchPlaceholder:"Поиск",processing:'<i class="fa fa-spinner fa-spin fa-2x loader"></i>',lengthMenu:"_MENU_",info:"_START_ до _END_ из _TOTAL_ записей",zeroRecords:"Записи отсутствуют",infoEmpty:"Записи с 0 до 0 из 0 записей",infoFiltered:"(из _MAX_ записей)",paginate:{first:'<i class="fa fa-angle-double-left" title="Первая"></i>',previous:'<i class="fa fa-angle-left" title="Предыдущая"></i>',next:'<i class="fa fa-angle-right" title="Следующая"></i>',last:'<i class="fa fa-angle-double-right" title="Последняя"></i>'}};case"zh":return{search:"",searchPlaceholder:"搜索",processing:'<i class="fa fa-spinner fa-spin fa-2x loader"></i>',lengthMenu:"_MENU_",info:"_START_ 至 _END_ 项结果，共 _TOTAL_ 项",zeroRecords:"没有匹配结果",infoEmpty:"显示第 0 至 0 项结果，共 0 项",infoFiltered:"(来自 _MAX_ 条记录)",paginate:{first:'<i class="fa fa-angle-double-left" title="首页"></i>',previous:'<i class="fa fa-angle-left" title="上页"></i>',next:'<i class="fa fa-angle-right" title="下页"></i>',last:'<i class="fa fa-angle-double-right" title="末页"></i>'}};case"ja":return{search:"",searchPlaceholder:"検索",processing:'<i class="fa fa-spinner fa-spin fa-2x loader"></i>',lengthMenu:"_MENU_",info:"_TOTAL_ 件中 _START_ から _END_ まで表示",zeroRecords:"一致するレコードがありません",infoEmpty:"0 件中 0 から 0 まで表示",infoFiltered:"(_MAX_ レコードから)",paginate:{first:'<i class="fa fa-angle-double-left" title="先頭"></i>',previous:'<i class="fa fa-angle-left" title="前"></i>',next:'<i class="fa fa-angle-right" title="次"></i>',last:'<i class="fa fa-angle-double-right" title="最終"></i>'}}}}return f.initialize(),e(document).on("click","#mSelect_"+u.plugin_id+" div.btn-group button.multiselect",function(t){var l=u.plugin_id,n=e(".mSelect-content").not(":hidden").attr("data-id");if(null!=n&&null!=n&&n!=l)return e(document).trigger("click"),e("#mSelect_"+l+" div.btn-group button.multiselect").trigger("click"),!1;e(".mSelect-content").hide();var a=e(this).closest("span").next("div:first"),s=e(this).attr("aria-expanded");!1===(s=null!=s&&JSON.parse(s))?(a.hide(),L(),x("close"),u.onDropdownHide.call(this,u.selectedIds,u.fullSelectedLabels,u.uniqueSelectedLabels,u.plugin_id)):(!0===u.loadWhenOpen&&!1===p&&(m(),p=!0),a.show(),x("open"),u.onDropdownShow.call(this,u.plugin_id))}),e(document).click(function(t){var l=e(t.target);if(l.parents(".mSelect-content").length>0||"mSelect-content"===l.attr("class")){var n=l;l.parents(".mSelect-content").length>0&&(n=l.parents(".mSelect-content"));var a=n.prev("span").first(),s=a.find("div"),i=a.find("button");e(i).attr("aria-expanded","true"),e(s).attr("class","btn-group open")}else{var c=e(".mSelect-content").not(":hidden").attr("data-id");u.plugin_id==c&&(e(".mSelect-content").not(":hidden").hide(),L(),x("close"),u.onDropdownHide.call(this,u.selectedIds,u.fullSelectedLabels,u.uniqueSelectedLabels,u.plugin_id))}}),e(document).on("click","#mSelect-content_"+u.plugin_id+" tbody tr",function(t){var l=e("#"+u.table_id).DataTable().row(this).data(),n=l[0],a=l[u.returnSelectedLabels.indexLabel];if(e(this).hasClass("selected"))-1===e.inArray(n,u.selectedIds)&&("single"==u.selectType&&(u.selectedIds=[],u.fullSelectedLabels=[],u.uniqueSelectedLabels=[]),u.selectedIds.push(n),!0===u.returnSelectedLabels.enable&&u.fullSelectedLabels.push({id:n,label:a}));else{var s=e.inArray(n,u.selectedIds);-1!==s&&(u.selectedIds.splice(s,1),!0===u.returnSelectedLabels.enable&&u.fullSelectedLabels.splice(s,1))}_(t)}),e(document).on("change","#mSelect-content_"+u.plugin_id+' th:first-child input[type="checkbox"]',function(t){if("single"==u.selectType)return e(this).prop("checked",!e(this).prop("checked")),!1;var l=[],n=[];e("#"+u.table_id).DataTable().rows().data().each(function(e,t){l.push(e[0]),!0===u.returnSelectedLabels.enable&&n.push(e[u.returnSelectedLabels.indexLabel])}),e(this).is(":checked")?e.each(l,function(t,l){if(-1===e.inArray(l,u.selectedIds)&&(u.selectedIds.push(l),!0===u.returnSelectedLabels.enable)){var a=n[t];u.fullSelectedLabels.push({id:l,label:a})}}):e.each(l,function(t,l){var n=e.inArray(l,u.selectedIds);-1!==n&&(u.selectedIds.splice(n,1),!0===u.returnSelectedLabels.enable&&u.fullSelectedLabels.splice(n,1))}),_(t)}),!1===u.loadWhenOpen&&(m(),p=!0),!0===u.reset&&v(),this.getPluginId=function(){return u.plugin_id},this.getTableId=function(){return u.table_id},this.getSelectedIds=function(){return u.selectedIds},this.getSelectedLabels=function(){return u.fullSelectedLabels},this.getUniqueSelectedLabels=function(){return u.uniqueSelectedLabels},this.getSelectInfos=function(){return{plugin_id:u.uniqueSelectedLabels,table_id:u.uniqueSelectedLabels,selectedIds:u.selectedIds,selectedLabels:u.fullSelectedLabels,uniqueSelectedLabels:u.uniqueSelectedLabels}},this.setCSS=function(t){e("#btn_"+u.plugin_id).removeAttr("style");var l=null==t?"":t,n=null!=u.buttonWidth?"width:"+u.buttonWidth+";":"";e("#btn_"+u.plugin_id).attr("style",n+l)},this.setLanguage=function(e){null!=l[e]&&(u.lang=e,b=l[u.lang],T())},this.setSelectedIds=function(t,l){if((t=y(t)).length>0){if(u.selectedIds=t,null!=l&&null!=l&&!0===u.returnSelectedLabels.enable){var n=[];e.each(t,function(e,t){null!=l[e]&&n.push({id:t,label:l[e]})}),u.fullSelectedLabels=n,L()}T()}else mSelect("reset")},this.mSelect=function(t,l){switch(t){case"reset":v();break;case"refresh":""!==l&&(void 0!==l.selectedIds&&(l.selectedIds=y(l.selectedIds)),u=e.extend({},u,l),T());break;case"enable":f.multiselect("enable");break;case"disable":f.multiselect("disable");break;case"resable":v(),f.multiselect("disable");break;case"show":f.closest("span").show();break;case"hide":f.closest("span").hide()}},f}}(jQuery);